16853-  // ============================================
16854-  // SUBJECT-BASED EDUCATION API (Primary/Secondary)
16855-  // ============================================
16856-
16857-  // Get subjects filtered by grade level and system (for primary/secondary students)
16858:  app.get("/api/subjects", async (req, res) => {
16859-    try {
16860-      const { gradeLevel, gradeSystem, creatorOnly } = req.query;
16861-      const user = req.user as any;
16862-      const isAdmin = user?.role === "admin";
16863-      
--
17010-      res.status(500).json({ success: false, error: "Failed to save progress" });
17011-    }
17012-  });
17013-
17014-  // Get student's progress across all subjects
17015:  app.get("/api/subjects/progress/:userId", async (req, res) => {
17016-    try {
17017-      const { userId } = req.params;
17018-      
17019-      const progressData = await db
17020-        .select({
--
17093-  // ============================================
17094-  // POST ENDPOINTS FOR SUBJECT-BASED EDUCATION
17095-  // ============================================
17096-
17097-  // Create a new subject
17098:  app.post("/api/subjects", async (req, res) => {
17099-    try {
17100-      const { name, gradeSystem, gradeLevel, description, iconUrl } = req.body;
17101-      
17102-      if (!name || !gradeSystem || !gradeLevel) {
17103-        return res.status(400).json({ 
--
17125-      res.status(500).json({ success: false, error: "Failed to create subject" });
17126-    }
17127-  });
17128-
17129-  // Delete a subject and all its related data
17130:  app.delete("/api/subjects/:subjectId", async (req, res) => {
17131-    try {
17132-      const { subjectId } = req.params;
17133-      
17134-      // Get all chapters for this subject
17135-      const chaptersToDelete = await db
--
17177-      console.error('Subject deletion error:', error);
17178-      res.status(500).json({ success: false, error: "Failed to delete subject" });
17179-    }
17180-  });
17181-  // Create a new chapter
17182:  app.post("/api/subjects/:subjectId/chapters", async (req, res) => {
17183-    try {
17184-      const { subjectId } = req.params;
17185-      const { title, description, order } = req.body;
17186-      
17187-      if (!title) {
